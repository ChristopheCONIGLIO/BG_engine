<!DOCTYPE html>
<html>
    <head>
        <title>C.CONIGLIO Project .js BG_engine</title>
        <style>
            * { margin:0; padding:0; }
            #canvas1{
               float: left;
               width: 100%;
               height: 100vh;
               background-color: rgb(14,113,179);/*rgba(40,113,164,255)*/
            }
        </style>
        <!-- import de BG engine -->
        <script type="text/javascript" src="../../SRC-BG-ENGINE/BG_EngineImport.js"></script>
        <script type="text/javascript"> loadBGengine("../..")</script>
        <script type="text/javascript" src="./src/BluePrint.js"></script>
    </head>
    <body>
        <div class="conteneur">
            <canvas id="canvas1" >BG_engine need a browser canvas HTML5 compatible</canvas>
        </div>
    </body>
    <script type="text/javascript">
        
       
        // --------------------------------------------------- //
        // --------------------------------------------------- //
        
        

        class objFolowTarget extends BG_circleBorder{
            // ---------------------
            
            constructor(velX,velY,next_pts,bg,onBoard,fixed,layer,pX,pY,size,color,border,colorborder,fond) {
                super(bg,onBoard,fixed,layer,pX,pY,size,color,border,colorborder,fond);
                this.velX = velX;
                this.velY = velY;
                this.next_pts = next_pts;
                TOTAL_OBJ++;
            }
            drawObj(decX,decY,zoom){
                
                super.drawObj(decX,decY,zoom);
                this.p_pX += this.velX;
                this.p_pY += this.velY;
                
                this.velX/=1.1;
                this.velY/=1.1;


                let velo = 2;
                let sgX = Math.sign(this.p_pX - LIST_PTS_TARGET[this.next_pts][0] );
                let sgY = Math.sign(this.p_pY - LIST_PTS_TARGET[this.next_pts][1] );
                let disX = Math.abs( this.p_pX - LIST_PTS_TARGET[this.next_pts][0] );
                let disY = Math.abs( this.p_pY - LIST_PTS_TARGET[this.next_pts][1] );
                let pcX = disX/(disX+disY);
                let pcY = disY/(disX+disY);
                this.velX += -sgX*velo*pcX;
                this.velY += -sgY*velo*pcY;
                
                
                let geofunc = new Geometry();

                if( geofunc.distance(this.p_pX,this.p_pY,LIST_PTS_TARGET[this.next_pts][0],LIST_PTS_TARGET[this.next_pts][1]) < 15){
                    this.next_pts++;
                    if( this.next_pts >= LIST_PTS_TARGET.length) this.next_pts = 0;

                    if( this.getDim() > 3){
                        if(Math.random() > 0.5 )var polyOnBoard     = new objFolowTarget( Math.random()*40-20+this.velX, Math.random()*20-10+this.velY,this.next_pts,BG_ENGINE,true,false,9,this.p_pX,this.p_pY,this.getDim()/1.5,"#0e71b3",2,"#FFFFFF",true);
                        if(Math.random() > 0.5 )var polyOnBoard     = new objFolowTarget( Math.random()*40-20+this.velX, Math.random()*20-10+this.velY,this.next_pts,BG_ENGINE,true,false,9,this.p_pX,this.p_pY,this.getDim()/1.5,"#0e71b3",2,"#FFFFFF",true);
                        if(Math.random() > 0.5 )var polyOnBoard     = new objFolowTarget( Math.random()*40-20+this.velX, Math.random()*20-10+this.velY,this.next_pts,BG_ENGINE,true,false,9,this.p_pX,this.p_pY,this.getDim()/1.5,"#0e71b3",2,"#FFFFFF",true);
                        if(Math.random() > 0.5 )var polyOnBoard     = new objFolowTarget( Math.random()*40-20+this.velX, Math.random()*20-10+this.velY,this.next_pts,BG_ENGINE,true,false,9,this.p_pX,this.p_pY,this.getDim()/1.5,"#0e71b3",2,"#FFFFFF",true);
                        if(Math.random() > 0.5 )var polyOnBoard     = new objFolowTarget( Math.random()*40-20+this.velX, Math.random()*20-10+this.velY,this.next_pts,BG_ENGINE,true,false,9,this.p_pX,this.p_pY,this.getDim()/1.5,"#0e71b3",2,"#FFFFFF",true);
                    }
                    this.p_bg.deleteObject(this);
                    TOTAL_OBJ--;
                    if( TOTAL_OBJ < 2){
                        var polyOnBoard     = new objFolowTarget( Math.random()*20-10+this.velX, Math.random()*20-10+this.velY,this.next_pts,BG_ENGINE,true,false,9,this.p_pX,this.p_pY,15,"#0e71b3",2,"#FFFFFF",true);
                        var polyOnBoard     = new objFolowTarget( Math.random()*20-10+this.velX, Math.random()*20-10+this.velY,this.next_pts,BG_ENGINE,true,false,9,this.p_pX,this.p_pY,15,"#0e71b3",2,"#FFFFFF",true);
                    }
                }
            }
        }
        

        //declaration de BG_engine
        var FPSTARGET = 30;
        var BG_ENGINE = new BG_engine("canvas1",60,FPSTARGET);
        var CODE = new BluePrint(BG_ENGINE,true);
        //this.cicleTestGreen = new BG_circle(bg_engine,true,8,150,150,50,"#FF0000");
        var TOTAL_OBJ = 0;
        var polyOnBoard     = new objFolowTarget(0,0,0,BG_ENGINE,true,false,9,0,0,15,"#0e71b3",2,"#FFFFFF",true);
        var polyOnBoard     = new objFolowTarget(0,0,4,BG_ENGINE,true,false,9,0,0,15,"#0e71b3",2,"#FFFFFF",true);
        /*for(var k = 0 ;k < 100;k++){
           var polyOnBoard     = new objFolowTarget(Math.random()*100,Math.random()*100,0,BG_ENGINE,true,false,9,0,0,15,"#0e71b3",2,"#FFFFFF",true);
        
        }*/

        //
        // visuel cartograhie
        //
        var map1     = new BG_drawImage(BG_ENGINE,true,false,3,100,0,437,571,"./map2.png");
        var map2     = new BG_drawImage(BG_ENGINE,true,false,3,-300,-50,263,339,"./map1.png");
        map2.setRotation(45);

        //
        // les Points 
        //
        var LIST_PTS_TARGET = new Array([222,440],[-229,156],[-102,95],[434,76],[419,261],[271,272]);
        for(var k = 0 ;k < LIST_PTS_TARGET.length ;k++){
            var obj     = new BG_circle(BG_ENGINE,true,false,4,LIST_PTS_TARGET[k][0],LIST_PTS_TARGET[k][1],50,"#00FF00");
            obj.setAlpha(0.5);
        }

        

        
        // --------------------------------------------------- //
        // --------------------------------------------------- //
       
    </script>
</html>

































